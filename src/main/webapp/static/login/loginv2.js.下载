var login=(function(){var C=120;var D=false;var p;var t=true;function w(E){p=E}function s(E){t=E}nyonline.jsonp("/login2/getc.c",{},function(E){w(E.hide);if(!E.hide){$("#picCode").show()}},function(E){});function B(){$("#picCode").show()}function b(){$("#picCode").hide()}function g(){$("#smsCode").show()}var f=function(){picCaptcha.getUrl("ups_login",function(E){$("#__loginchapcha").attr("src",E)})};var o=function(){picCaptcha.getUrl("ups_loginForMobileCode",function(E){$("#__loginchapcha").attr("src",E)})};var A=function(E){return/^1[3|4|5|7|8][0-9]\d{8}$/.test(E)};var r=function(E){return/^[A-Z|a-z|0-9]{4,6}$/.test(E)};var l=function(E){return/^[0-9]{6}$/.test(E)};var d=function(E){if(null!=E&&$.trim(E)!=""){return false}else{return true}};var a=0;var j=function(E,F){a=E;$("#warnBox").empty();$("#warnBox").append("<span></span>"+F)};var y=function(E){if(a==E){$("#warnBox").empty()}};var n=function(){$(":input").parent().removeClass("srBox1");var F=true;var E=true;$(":input").parent().removeClass("srBox2");$(".checkClass").each(function(G){if(this.id=="__vcode"){if(p){return true}}if(this.id=="__mvcode"){if(t){return true}}if($.trim($(this).val())==""){E=false;$(this).parent().addClass("srBox2")}});if(!E){a=1;$("#warnBox").empty();$("#warnBox").append("<span></span>请将登录信息填写完整");F=false;return F}else{if(a==1){$("#warnBox").empty()}}F=A($("#__name").val());if(F){if(a==2){$("#warnBox").empty()}}else{a=2;$("#warnBox").empty();$("#warnBox").append("<span></span>您输入的手机号码格式不正确");return F}if(!p){F=r($("#__vcode").val());if(F){if(a==3){$("#warnBox").empty()}}else{a=3;$("#warnBox").empty();$("#warnBox").append("<span></span>您输入的图形验证码错误");$("#__vcode").val("");f();return F}}if(!t){F=k();return F}return F};var k=function(){var E=true;if(!d($("#__mvcode").val())){E=l($("#__mvcode").val());if(E){y(6)}else{j(6,"您输入的手机验证码格式不正确")}}return E};var v=function(){var E=true;if(!d($("#__vcode").val())){y(1);E=r($("#__vcode").val());if(E){y(3)}else{a=3;$("#warnBox").empty();$("#warnBox").append("<span></span>您输入的图形验证码错误");$("#__vcode").val("");o();E=false}}else{a=1;$("#warnBox").empty();$("#warnBox").append("<span></span>请将登录信息填写完整");$("#__vcode").parent().addClass("srBox2");E=false}return E};var d=function(E){if(null!=E&&$.trim(E)!=""){return false}else{return true}};var z=function(H,E){var G=new Array();for(var F in H){$.ajax({type:"GET",url:H[F],async:false,scriptCharset:"utf-8",contentType:"application/json",dataType:"jsonp",success:function(I){var J=G.push(1);if(J==H.length&&E!=""){location.href=E}},error:function(I){MsgBox.tips("提示","登录异常，请重试！")}})}};var i=function(){var E=true;if(!d($("#__name").val())){E=A($("#__name").val());if(E){y(1);$("#__name").next().show()}else{j(1,"您输入的手机号码格式不正确");$("#__name").next().hide()}}else{$("#__name").next().hide()}return E};var u=function(H,G,E,F,I){if(d(H)){j(9,"请输入手机号码");D=false;E&&E();return}if(!i()){D=false;E&&E();return}if(!v()){D=false;E&&E();return}$("#__reggetmocha").text("发送中...");nyonline.jsonp("/loginpc/getSmsLoginMobileVcodeVithPic.c",{mobileno:H,type:F,vcode:I},function(J){if(J.code==-35){D=false;j(0,"系统服务出错，请稍后再试");return}try{G&&G(J)}catch(K){}D=false},function(){j(0,"网络连接异常，请稍后再试")})};var m=function(H,G,I){$(H).attr("_countdown",parseInt(new Date().getTime()/1000+G,10));var E=true;var F;var J=function(){var K=parseInt($(H).attr("_countdown"),10);var L=parseInt(K-new Date().getTime()/1000,10);if(L>0){if(E){$(H).show();$(I).hide();E=false}$(H).text(L+"s重新获取");setTimeout(function(){J()},1000)}else{$("#__vcode").val("");o();$("#__reggetmocha").text("点击获取");$(H).hide();$(I).show();clearTimeout(F)}};F=setTimeout(function(){J()},0)};var q=function(F,E){return nyonline.md5(F+E.toUpperCase()).toString()};var e=false;var h=function(){var E=n();if(!E){return}if(e){return}e=true;var F={};F={name:$("#__name").val()};nyonline.jsonp("/login/initLogin.c",F,function(H){$("#__loginbox input").each(function(I,J){F[$(J).attr("name")]=$(J).val()});e=false;switch(H.code){case 0:var G=H.salt;F.salt=G;F.saltPwd=q(F.saltPwd,F.salt);nyonline.jsonp("/loginpc/do.c",F,function(I){switch(I.code){case 0:if(callbackUrl==""){callbackUrl=mainserver("")}if(I.newer_guide_switch){location.href=mainserver("/newerGuide/intercept.c")+"?callbackUrl="+callbackUrl+"&isSkip="+isSkip}else{location.href=callbackUrl}break;case -6:$("#__vcode").val("");f();$("#warnBox").empty();$("#warnBox").append("<span></span>您输入的图形验证码错误");break;case -10:$("#warnBox").empty();$("#warnBox").append("<span></span>您输入的手机号或密码错误，请重新输入");if(t){f()}w(false);break;case -2:MsgBox.tips("提示","由于连续多次输入密码错误，您的账户已被锁定，<br/>请通过忘记密码解锁或联系客服");w(false);f();break;case -3:$("#warnBox").empty();$("#warnBox").append("<span></span>您输入的手机号或密码错误，请重新输入");f();break;case -42:var J=I.msg||"请输入手机验证码";$("#__vcode").val("");g();s(false);o();break;case -7:$("#warnBox").empty();$("#warnBox").append("<span></span>您输入的手机验证码错误");break;case -120:var J=I.msg||"系统升级维护中，请稍后";MsgBox.tips("提示",I.msg);break;case -121:var J=I.msg||"系统处理有误，请稍后重试";MsgBox.tips("提示",I.msg);f();break;case -85:var J=I.msg||"您的账户不允许登录，请稍后";MsgBox.tips("提示",I.msg);break;case -103:var J=I.msg||"账务系统升级维护，稍后再试";MsgBox.tips("提示",I.msg);f();break;case -106:w(false);break;default:f();var J=I.msg||"系统升级维护中，请稍后";MsgBox.tips("提示",J+",ret="+I.code)}if(I.code<0){B()}},function(I){MsgBox.tips("提示","登录失败")});break;default:$("#warnBox").empty();$("#warnBox").append("<span></span>您输入的手机号或密码错误，请重新输入");f();break}},function(G){e=false;MsgBox.tips("提示","登录失败")})};var c=function(){$("#__reggetmocha").click(function(){y(0);if(D){return}D=true;u($("#__name").val(),function(E){D=false;switch(E.code){case 0:m($("#__chatime"),C,$("#__reggetmocha"));break;case -8:j(0,"您的操作过于频繁，请2分钟后再试");o();break;case -6:j(0,"您输入的图形验证码错误，请重新输入");$("#__vcode").val("");o();break;case -82:j(0,"操作频繁，请隔一段时间后再尝试操作");break;default:j(0,"操作超时，请刷新页面重试，ret="+E.code);o();break}$("#__reggetmocha").text("点击获取")},function(){},"PC_LOGIN_VERIFY",$("#__vcode").val())});$("#__loginchapcha").click(function(){if(!t){o()}else{f()}});$("#__btnLogin").click(function(){h()});$("input").keydown(function(E){if(E.which==13){$("#__btnLogin").click()}});$("#__name").blur(function(){if(!d($("#__name").val())){var E=A($("#__name").val());if(E){if(a==2){$("#warnBox").empty()}var F={name:$("#__name").val()};nyonline.jsonp("/loginpc/hpc.c",F,function(G){switch(G.code){case 0:if(t){w(true);b()}break;case -42:$("#__vcode").val("");g();s(false);o();break;case -106:w(false);break}if(G.code<0){B()}},function(G){})}else{a=2;$("#warnBox").empty();$("#warnBox").append("<span></span>您输入的手机号码格式不正确")}}})};var x=function(){placeHolder2.placeholderSupport();$winH=$(window).height()+"px";$(".bigBg").height($winH);$halfH=-$(".whiteBg").height()/2+"px";$(".whiteBg").css("margin-top",$halfH);$(":input").focus(function(){$(this).parent().addClass("srBox1").siblings().removeClass("srBox1")});c();picCaptcha.init(vidSign,function(){f()})};return{init:x}})();