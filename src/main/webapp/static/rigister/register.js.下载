var register=(function(){var y=120;var z=false;var x=function(A){return/^1[3|4|5|7|8][0-9]\d{8}$/.test(A)};var t=function(C){var B=/[A-Z|a-z]/.test(C);var A=/[0-9]/.test(C);return B&&A&&/^[\S| ]{6,16}$/.test(C)};var n=function(A){return/^[A-Z|a-z|0-9]{4,6}$/.test(A)};var h=function(A){return/^[0-9]{6}$/.test(A)};var a=0;var f=function(A,B){a=A;$("#__warnBox").empty();$("#__warnBox").append("<span></span>"+B)};var w=function(A){if(a==A){$("#__warnBox").empty()}};var b=function(A){if(null!=A&&$.trim(A)!=""){return false}else{return true}};var e=function(){var A=true;if(!b($("#__registMobileNo").val())){A=x($("#__registMobileNo").val());if(A){w(1);$("#__registMobileNo").next().show()}else{f(1,"您输入的手机号码格式不正确");$("#__registMobileNo").next().hide()}}else{$("#__registMobileNo").next().hide()}return A};var o=function(){var A=true;if(!b($("#__onepwd").val())){A=t($("#__onepwd").val());if(A){w(2);$("#__onepwd").next().show()}else{f(2,"包含数字和字母的6~16位密码");$("#__onepwd").next().hide()}}else{$("#__onepwd").next().hide()}return A};var r=function(){var A=true;if(!b($("#__twopwd").val())){A=t($("#__twopwd").val());if(A){w(3);$("#__twopwd").next().show()}else{f(3,"包含数字和字母的6~16位密码");$("#__twopwd").next().hide()}}else{$("#__twopwd").next().hide()}return A};var d=function(){var A=true;if(!b($("#__onepwd").val())&&!b($("#__twopwd").val())){A=$("#__onepwd").val()==$("#__twopwd").val();if(!A){f(4,"两次输入的密码不一致，请重新输入");$("#__twopwd").next().hide()}else{w(4);$("#__twopwd").next().show()}}else{$("#__twopwd").next().hide()}return A};var q=function(){var A=true;A=n($("#__picvcode").val());if(A){w(5)}else{f(5,"您输入的图形验证码错误，请重新输入")}return A};var g=function(){var A=true;if(!b($("#__mvcode").val())){A=h($("#__mvcode").val());if(A){w(6)}else{f(6,"您输入的手机验证码格式不正确")}}return A};var u=function(){var A=true;if($.trim($("#__recperson").val())!=""){A=x($("#__recperson").val())}if(A){w(7)}else{f(7,"您输入的推荐人手机号码格式不正确")}return A};var l=function(){$(":input").parent().removeClass("srBox1");var B=true;$(':input:not("#__recperson")').parent().removeClass("srBox2");var A=true;$(':input:not("#__recperson")').each(function(C){if($.trim($(this).val())==""){A=false;$(this).parent().addClass("srBox2")}});if(!A){f(8,"请将注册信息填写完整");B=false;return B}else{w(8)}B=e();if(!B){return B}B=o();if(!B){return B}B=r();if(!B){return B}B=d();if(!B){return B}B=q();if(!B){return B}B=g();if(!B){return B}B=u();if(!B){return B}return B};var p=function(D,C,A,B,E){if(b(D)){f(9,"请输入手机号码");z=false;A&&A();return}if(!e()){z=false;A&&A();return}$("#__reggetmocha").text("发送中...");nyonline.jsonp("/login2/getmobilevcodewithpic.c",{mobileno:D,type:B,vcode:E,channel:"ups_regist",did:register.df},function(F){if(F.code==-35){z=false;f(0,"系统服务出错，请稍后再试");return}try{C&&C(F)}catch(G){}z=false},function(){f(0,"网络连接异常，请稍后再试")})};var k=function(D,C,E){$(D).attr("_countdown",parseInt(new Date().getTime()/1000+C,10));var A=true;var B;var F=function(){var G=parseInt($(D).attr("_countdown"),10);var H=parseInt(G-new Date().getTime()/1000,10);if(H>0){if(A){$(D).show();$(E).hide();A=false}$(D).text(H+"s重新获取");setTimeout(function(){F()},1000)}else{$("#__reggetmocha").text("点击获取");$(D).hide();$(E).show();clearTimeout(B)}};B=setTimeout(function(){F()},0)};var m=function(B,A){return nyonline.md5(B+A.toUpperCase()).toString()};var i=false;var j=function(){w(0);var A=l();if(!A){return}if(i){return}i=true;var B={};$("input").each(function(C,D){B[$(D).attr("name")]=$(D).val()});B.__pwd="";B.confirmPwd="";B.saltPwd=m(B.saltPwd,B.salt);nyonline.jsonp("/login/register.c",B,function(C){i=false;$("#__btnRegist").toggleClass("active gray",false);switch(C.code){case 0:if(C.newer_guide_switch){window.top.location.href=mainserver("/newerGuide/registSucIntercept.c")}else{window.top.location.href=server("/regist/registSuccess.c")}break;case -9:f(0,"该手机号已被注册，可直接登录");break;default:f(0,C.msg);return}},function(C){i=false;f(0,C)})};var s=function(){picCaptcha.getUrl("ups_regist",function(A){$("#__regchapcha").attr("src",A)})};var c=function(){$("#__reggetmocha").click(function(){w(0);if(z){return}z=true;p($("#__registMobileNo").val(),function(A){z=false;switch(A.code){case 0:k($("#__chatime"),y,$("#__reggetmocha"));break;case -8:f(0,"您的操作过于频繁，请2分钟后再试");s();break;case -9:f(0,"该手机号已被注册，可直接登录");s();break;case -6:f(0,"您输入的图形验证码错误，请重新输入");$("#__picvcode").val("");s();break;case -82:f(0,"操作频繁，请隔一段时间后再尝试操作");break;default:f(0,"操作超时，请刷新页面重试，ret="+A.code);s();break}$("#__reggetmocha").text("点击获取")},function(){},"REGIST",$("#__picvcode").val())});$("#__regchapcha").click(function(){s()});$("#__btnRegist").click(function(){j()});$("input").keydown(function(A){if(A.which==13){$("#__btnRegist").click()}});$("#__registMobileNo").blur(function(){e()});$("#__onepwd").blur(function(){o()});$("#__twopwd").blur(function(){var A=r();if(A){d()}});$("#__mvcode").blur(function(){g()});$("#__recperson").blur(function(){u()});$(":input").focus(function(){$(this).parent().addClass("srBox1").siblings().removeClass("srBox1")});$("#showAgreementBtn").click(function(){$("#agreementBox").show()});$("#hideAgreementBtn").unbind();$("#hideAgreementBtn").click(function(){$("#agreementBox").hide()})};var v=function(){placeHolder2.placeholderSupport();scrollbar("obj","box1","box2","box3","box4");$winH=$(window).height()+"px";$(".bigBg").height($winH);$halfH=-$(".whiteBg").height()/2+"px";$(".whiteBg").css("margin-top",$halfH);$("#register.whiteBg").css("margin-top",-($(".whiteBg").height()/2-40)+"px");nyonline.jsonp("/login/initregister.c",null,function(A){$("#__salt").val(A.salt);picCaptcha.init(vidSign,function(){s()})},function(A){});c()};return{init:v}})();